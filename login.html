<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login and Signup</title>
    <link rel="stylesheet" href="styles.css">
      
</head>
<body >

    <div id="message-box"></div>

    <section class="forms-section" >
        <h1 class="section-title">Welcome to Ai SCRiBE </h1>
        <div class="forms" >
            <script src="https://unpkg.com/@dotlottie/player-component@latest/dist/dotlottie-player.mjs" type="module"></script> 

            <dotlottie-player src="https://lottie.host/1617db0a-6321-4492-8a61-04a4fdf62036/niEgaeYbzb.json" background="transparent" speed="1" style="width: 500px; height: 400px;" loop autoplay></dotlottie-player>
          <div class="form-wrapper is-active">
            <button type="button" class="switcher switcher-login">
              Login
              <span class="underline"></span>
            </button>
            <form class="form form-login" id="login-form">
              <fieldset>
                <legend>Please, enter your username and password for login.</legend>
                <div class="input-block">
                  <label for="login-email">Username</label>
                  <input id="login-username"  required>
                </div>
                <div class="input-block">
                  <label for="login-password">Password</label>
                  <input id="login-password" type="password" required>
                </div>
              </fieldset>
              <button type="submit" class="btn-login">Login</button>
            </form>
          </div>
          <div class="form-wrapper">
            <button type="button" class="switcher switcher-signup">
              Sign Up
              <span class="underline"></span>
            </button>
            <form class="form form-signup" id="signup-form">
              <fieldset>
                <legend>Please, enter your username, email and password for sign up.</legend>
                
                <div class="input-block">
                    <label for="signup-username">Username</label>
                    <input id="signup-username"  required>
                  </div>
                <div class="input-block">
                  <label for="signup-email">E-mail</label>
                  <input id="signup-email" type="email" required>
                </div>
                <div class="input-block">
                  <label for="signup-password">Password</label>
                  <input id="signup-password" type="password" required>
                </div>
              </fieldset>
              <button type="submit" class="btn-signup">Sign Up</button>
            </form>
          </div>
        </div>
      </section>






























    
    <!-- <h1>Login</h1>
    <form class="auth-form" id="login-form" >
        <label for="login-username">Username:</label>
        <input type="text" id="login-username" name="username" required>
        <label for="login-password">Password:</label>
        <input type="password" id="login-password" name="password" required>
        <button type="submit">Login</button>
    </form>

    <h1>Signup</h1>
    <form class="auth-form" id="signup-form" >
        <label for="signup-username">Username:</label>
        <input type="text" id="signup-username" name="signup-username" required>
        <label for="signup-password">Password:</label>
        <input type="password" id="signup-password" name="signup-password" required>
        <button type="submit"  >Signup</button>
    </form> -->

    <script>

const switchers = [...document.querySelectorAll('.switcher')]

switchers.forEach(item => {
	item.addEventListener('click', function() {
		switchers.forEach(item => item.parentElement.classList.remove('is-active'))
		this.parentElement.classList.add('is-active')
	})
})
        document.addEventListener("DOMContentLoaded", () => {
            const loginForm = document.getElementById("login-form");
            const signupForm = document.getElementById("signup-form");
            const messageBox = document.getElementById("message-box");

            // WebSocket connection to your server
            const ws = new WebSocket("wss://aiscribe.onrender.com");

            ws.onopen = () => {
                console.log("WebSocket connection established");
            };

           /* ws.onmessage = (event) => {
                const message = JSON.parse(event.data);
                if (messageBox) {
                    messageBox.innerHTML = message.message;
                }
                console.log("Received message:", message);
            };*/
ws.onmessage = (event) => {
    const message = JSON.parse(event.data);
    if (messageBox) {
        messageBox.innerHTML = message.message;
    }
    console.log("Received message:", message);

    if (message.success) {
    // Store the username in Local Storage
    localStorage.setItem('username', message.username);

    // Redirect to index.html
    window.location.href = 'index.html';
}
};

            ws.onclose = () => {
                console.log("WebSocket connection closed");
            };

            // Handle login form submission
            loginForm.addEventListener("submit", (e) => {
                e.preventDefault();
                // Construct login request message
                const loginData = {
                    type: "login",
                    username: document.getElementById('login-username').value,
                    password: document.getElementById('login-password').value,
                };
                // Send login request
                ws.send(JSON.stringify(loginData));
            });

            // Handle signup form submission
            signupForm.addEventListener("submit", (e) => {
                e.preventDefault();
                // Construct signup request message
                const signupData = {
                    type: "signup",
                    username: document.getElementById('signup-username').value,
                    password: document.getElementById('signup-password').value,
                };
                // Send signup request
                ws.send(JSON.stringify(signupData));
            });
        });
    </script>
    
</body>
</html>
